---
title: API·IP地址转实际地址
date: 2017-09-09 09:29:00
categories:
 - [Coding, Python]
tags: 
permalink: /archives/579/
---

参照之前脚本中使用的 [JohnWong/python-tool](https://github.com/JohnWong/python-tool) 提供的`http://pytool.sinaapp.com/` 接口实现方法，做以下修改：

 1. 对原方法中的`py2+新浪SAE+wsgi`实现形式，使用`py3+Flask+blueprint`的形式进行改造；
 2. 移除了无用的linkedin、weibo图案生成部分，合并剩余模块到同一utils中；
 3. 移除GBK编码导出，移除XML形式导出。
 4. 更新IPv4数据库。

调用方法如下：

----------

## 接口名称
IPv4、IPv6通用地址反查工具

### 1) 请求地址

> https://api.rhilip.info/tool/geo?ip={ip}

### 2) 调用方式：HTTP get

### 3) 接口描述：

* 通过IP地址反查相关地址。
* 使用数据库：`ipv6wry.db(20150419)` 、 `qqwry.dat(20170225)`

### 4) 请求参数:

#### GET参数:
|字段名称       |字段说明         |类型            |必填            |备注     |
| -------------|:--------------:|:--------------:|:--------------:| ------:|
|ip|IP address|string|Y| IPv4 or IPv6 |


### 5) 请求返回结果:

#### 请求成功

```json
{
  "ip": "2402:f000:1:1141:211:32ff:fe6b",
  "loc": "北京市 清华大学",
  "stats": "Success"
}
```

#### 请求失败
- 请求param中没有ip字段

```json
{
  "ip": null,
  "loc": null,
  "stats": "Not Find IP address."
}
```

- ip地址格式错误

```json
{
  "ip": "asdfas",
  "loc": null,
  "stats": "Can't Format IP address."
}
```
